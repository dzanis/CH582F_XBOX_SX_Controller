# CH582 в роли хоста для геймпада Xbox Series X

Этот проект позволяет микроконтроллеру CH582 выступать в качестве хоста (BLE Central) и подключаться к геймпаду Microsoft Xbox Series X.

Проект управляет процессом BLE-сканирования, сопряжения (Bonding), MAC-адрес геймпада в EEPROM и приемом данных о положении стиков и кнопок (HID Input Reports).

## Индикация светодиода (LED)

Светодиод на плате CH582 используется для индикации текущего состояния:

* **Медленное мигание** (1 раз в секунду):
    * **Значение:** Идет сканирование. CH582 ищет геймпад в эфире.
    * **Действие:** Нажмите и удерживайте кнопку **"Connect"**

* **Быстрое мигание** (несколько раз в секунду):
    * **Значение:** Устройство найдено, идет процесс сопряжения (Pairing/Bonding) и настройки.
    * **Действие:** Нажмите и удерживайте кнопку **"Connect"** пока мигание не прекратится

* **Горит постоянно:**
    * **Значение:** Геймпад успешно подключен, канал зашифрован, данные поступают.
    * **Действие:** Готово к работе!

---

## Как подключить геймпад (подробно)

### Первое подключение (Сопряжение и Сохранение)

Цель этого этапа — "познакомить" CH582 и геймпад, а также сохранить MAC-адрес геймпада в EEPROM.

1.  Включите CH582. Светодиод (LED) должен начать **медленно мигать** (режим сканирования).
2.  Возьмите геймпад Xbox. Нажмите и удерживайте кнопку **"Connect"** (маленькая круглая кнопка сверху геймпада), пока кнопка "Xbox" не начнет быстро мигать.
3.  CH582 обнаружит геймпад. LED на CH582 переключится на **быстрое мигание** (идет сопряжение).
4.  Через несколько секунд в логе (UART) появится сообщение `Bond save success`. MAC-адрес геймпада сохранен.
5.  **ВАЖНО:** На этом этапе нотификации, скорее всего, **не** пойдут. LED на CH582 продолжит быстро мигать, а геймпад продолжит поиск (кнопка "Xbox" будет моргать). *Это нормально.*
6. Продолжить приём данных из контроллёра можно повторным долгим нажатием на **"Connect"** или выключением XBOX контроллера


### Последующие подключения

После того как вы один раз выполнили **Первое подключение** , сопряжение сохранено.

Теперь достаточно просто включить геймпад кнопкой "Xbox". Он автоматически найдет CH582, и LED на обоих устройствах сразу загорится **постоянно**, пропуская все этапы настройки.